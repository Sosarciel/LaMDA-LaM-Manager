{
	"$schema": "http://json-schema.org/draft-07/schema#",
	"definitions": {
		"CredServiceJsonTable": {
			"allOf": [
				{
					"description": "服务管理器基础配置",
					"type": "object",
					"properties": {
						"max_resource": {
							"description": "最大允许资源量 未设置则视为无限",
							"type": "number"
						}
					}
				},
				{
					"type": "object",
					"properties": {
						"instance_table": {
							"type": "object",
							"additionalProperties": {
								"allOf": [
									{
										"description": "服务基础配置",
										"type": "object",
										"properties": {
											"name": {
												"description": "服务实例名",
												"type": "string"
											},
											"rollback": {
												"description": "此服务若失败则尝试回退的实例名",
												"type": "string"
											},
											"resource_usage": {
												"description": "此服务的资源占用量\n省略将视为0\n小于等于0时不会尝试卸载",
												"type": "number"
											}
										},
										"required": [
											"name"
										]
									},
									{
										"type": "object",
										"properties": {
											"type": {
												"$ref": "#/definitions/P",
												"description": "服务类型"
											},
											"data": {
												"$ref": "#/definitions/Opt",
												"description": "此实例的初始化数据"
											}
										},
										"required": [
											"data",
											"type"
										]
									}
								]
							}
						}
					},
					"required": [
						"instance_table"
					]
				}
			]
		},
		"CredCategoryJsonTable": {
			"type": "object",
			"properties": {
				"category_table": {
					"type": "object",
					"additionalProperties": {
						"description": "账户类型数据",
						"type": "object",
						"properties": {
							"id": {
								"$ref": "#/definitions/CredCategoryID",
								"description": "此账户类型的id"
							},
							"hostname": {
								"description": "此类型账户的hostname",
								"type": "string"
							},
							"port": {
								"description": "此类型账户的port",
								"type": "number"
							},
							"proxy_url": {
								"description": "是否使用代理",
								"type": "string"
							},
							"protocol": {
								"description": "所用协议 默认https",
								"enum": [
									"http",
									"https"
								],
								"type": "string"
							},
							"retry": {
								"$ref": "#/definitions/Partial",
								"description": "重试设定 PromiseRetries"
							},
							"model_id_map": {
								"$ref": "#/definitions/Record",
								"description": "modelid 映射  \n用于处理类似SiliconFlow的模型id不一致问题"
							}
						},
						"required": [
							"hostname",
							"id",
							"port"
						]
					}
				}
			},
			"required": [
				"category_table"
			]
		},
		"LaMServiceJsonTable": {
			"description": "用于实例加载",
			"allOf": [
				{
					"description": "服务管理器基础配置",
					"type": "object",
					"properties": {
						"max_resource": {
							"description": "最大允许资源量 未设置则视为无限",
							"type": "number"
						}
					}
				},
				{
					"type": "object",
					"properties": {
						"instance_table": {
							"type": "object",
							"additionalProperties": {
								"$ref": "#/definitions/ServiceConfig<{HttpAPIModel:(d:HttpAPIModelData)=>Promise<HttpAPIModelDrive>;Test:(d:{})=>Promise<TestModule>;}>"
							}
						}
					},
					"required": [
						"instance_table"
					]
				}
			]
		},
		"P": {
			"type": "string",
			"const": "Common"
		},
		"__type": {
			"description": "账号数据",
			"type": "object",
			"properties": {
				"api_key": {
					"description": "APIKey",
					"anyOf": [
						{
							"type": "array",
							"items": {
								"type": "string"
							}
						},
						{
							"type": "string"
						}
					]
				},
				"is_available": {
					"description": "有效的",
					"type": "boolean"
				},
				"used_credit": {
					"description": "使用的额度 单位 千分之一USD",
					"type": "number"
				},
				"credit_limit": {
					"description": "额度限制 单位 千分之一USD",
					"type": "number"
				},
				"cred_category": {
					"description": "凭证类别 由 CredCategoryJsonTable 定义",
					"type": "string"
				}
			},
			"required": [
				"api_key",
				"cred_category"
			]
		},
		"Opt": {
			"$ref": "#/definitions/__type"
		},
		"CredCategoryID": {
			"type": "string"
		},
		"Partial": {
			"$ref": "#/definitions/Partial_1"
		},
		"__type_1": {
			"type": "object",
			"properties": {
				"count": {
					"description": "重试次数 默认3",
					"type": "number"
				},
				"try_interval": {
					"description": "尝试间隔时间/毫秒 超过此事件会重新创建新的Promise\n同时等待新的与旧的Promise 默认180_000\n最小1000毫秒, 小于1000则视为无限",
					"type": "number"
				},
				"try_delay": {
					"description": "尝试延迟/毫秒 重新尝试时会先等待此毫秒数\n默认0",
					"type": "number"
				},
				"exp_backoff": {
					"description": "是否使用指数回退 默认false 仅在tryDelay被设置时有效",
					"type": "boolean"
				},
				"exp_backoff_max": {
					"description": "指数回退上限值 默认无限",
					"type": "number"
				},
				"flag": {
					"description": "此重试任务的标志",
					"type": "string"
				},
				"log": {
					"description": "是否打印重试步骤 默认true",
					"type": "boolean"
				}
			}
		},
		"Partial_1": {
			"$ref": "#/definitions/__type_1"
		},
		"Record": {
			"$ref": "#/definitions/Record_1"
		},
		"__type_2": {
			"type": "object"
		},
		"Record_1": {
			"$ref": "#/definitions/__type_2"
		},
		"ServiceConfig<{HttpAPIModel:(d:HttpAPIModelData)=>Promise<HttpAPIModelDrive>;Test:(d:{})=>Promise<TestModule>;}>": {
			"description": "服务构造函数表所对应的单个服务的配置表\n将 类型:工厂函数 映射 转换为完整配置文件",
			"anyOf": [
				{
					"allOf": [
						{
							"description": "服务基础配置",
							"type": "object",
							"properties": {
								"name": {
									"description": "服务实例名",
									"type": "string"
								},
								"rollback": {
									"description": "此服务若失败则尝试回退的实例名",
									"type": "string"
								},
								"resource_usage": {
									"description": "此服务的资源占用量\n省略将视为0\n小于等于0时不会尝试卸载",
									"type": "number"
								}
							},
							"required": [
								"name"
							]
						},
						{
							"type": "object",
							"properties": {
								"type": {
									"$ref": "#/definitions/P_1",
									"description": "服务类型"
								},
								"data": {
									"$ref": "#/definitions/Opt_1",
									"description": "此实例的初始化数据"
								}
							},
							"required": [
								"data",
								"type"
							]
						}
					]
				},
				{
					"allOf": [
						{
							"description": "服务基础配置",
							"type": "object",
							"properties": {
								"name": {
									"description": "服务实例名",
									"type": "string"
								},
								"rollback": {
									"description": "此服务若失败则尝试回退的实例名",
									"type": "string"
								},
								"resource_usage": {
									"description": "此服务的资源占用量\n省略将视为0\n小于等于0时不会尝试卸载",
									"type": "number"
								}
							},
							"required": [
								"name"
							]
						},
						{
							"type": "object",
							"properties": {
								"type": {
									"$ref": "#/definitions/P_2",
									"description": "服务类型"
								},
								"data": {
									"$ref": "#/definitions/Opt_2",
									"description": "此实例的初始化数据"
								}
							},
							"required": [
								"data",
								"type"
							]
						}
					]
				}
			]
		},
		"P_1": {
			"type": "string",
			"const": "HttpAPIModel"
		},
		"__type_3": {
			"description": "适用于网络API的文本完成模型数据",
			"type": "object",
			"properties": {
				"default_option": {
					"$ref": "#/definitions/TextCompletionOptions",
					"description": "默认请求选项"
				},
				"config": {
					"$ref": "#/definitions/HttpApiModelCategory"
				}
			},
			"required": [
				"config"
			]
		},
		"TextCompletionOptions": {
			"description": "文本完成模型通用配置",
			"$ref": "#/definitions/Partial_2"
		},
		"__type_4": {
			"type": "object",
			"properties": {
				"max_tokens": {
					"description": "最大token数",
					"type": "number"
				},
				"temperature": {
					"description": "temperature 采样温度 越大越容易选择低概率token",
					"type": "number"
				},
				"top_p": {
					"description": "top_p 越低可选的token越少,优先淘汰掉最低概率的token",
					"type": "number"
				},
				"stop": {
					"description": "stop字符串数组",
					"anyOf": [
						{
							"type": "array",
							"items": {
								"type": "string"
							}
						},
						{
							"type": "null"
						}
					]
				},
				"presence_penalty": {
					"description": "存在惩罚 只要token出现在提示中,出现概率就会受到惩罚",
					"type": "number"
				},
				"frequency_penalty": {
					"description": "频率惩罚 token每出现一次,出现概率就会受到一次惩罚",
					"type": "number"
				},
				"logit_bias": {
					"description": "逻辑对数偏置 {\"token\":偏置值} 对特定token的出现率调整",
					"anyOf": [
						{
							"$ref": "#/definitions/Record_2"
						},
						{
							"type": "null"
						}
					]
				},
				"n": {
					"description": "产生回复的数量",
					"type": "number"
				},
				"think_budget": {
					"description": "思考token预算 模型将尽量保证思考链长度为此值",
					"type": [
						"null",
						"number"
					]
				}
			}
		},
		"__type_5": {
			"type": "object"
		},
		"Record_2": {
			"$ref": "#/definitions/__type_5"
		},
		"Partial_2": {
			"$ref": "#/definitions/__type_4"
		},
		"__type_6": {
			"description": "适用于网络API的文本完成模型类别配置",
			"type": "object",
			"properties": {
				"id": {
					"description": "模型id",
					"type": "string"
				},
				"alias": {
					"description": "模型别名",
					"anyOf": [
						{
							"type": "array",
							"items": {
								"type": "string"
							}
						},
						{
							"type": "string"
						}
					]
				},
				"endpoint": {
					"description": "此模型api的标准路径",
					"type": "string"
				},
				"valid_account": {
					"description": "支持此模型的账号, 优先度排序",
					"type": "array",
					"items": {
						"type": "string"
					}
				},
				"price": {
					"$ref": "#/definitions/APIPrice",
					"description": "此模型的官方价格"
				},
				"chat_formater": {
					"$ref": "#/definitions/ChatFormaterType",
					"description": "此模型的聊天任务格式化工具"
				},
				"interactor": {
					"$ref": "#/definitions/RequestFormaterType",
					"description": "此模型的交互器"
				},
				"tokensizer": {
					"$ref": "#/definitions/TokensizerType",
					"description": "此模型所用的分词器"
				}
			},
			"required": [
				"alias",
				"chat_formater",
				"endpoint",
				"id",
				"interactor",
				"price",
				"tokensizer",
				"valid_account"
			]
		},
		"__type_7": {
			"description": "价格",
			"type": "object",
			"properties": {
				"promptPrice": {
					"description": "提示每 1 token 价格 单位: 1/1000 usd",
					"type": "number"
				},
				"completionPrice": {
					"description": "完成每 1 token 价格 单位: 1/1000 usd",
					"type": "number"
				},
				"cacheHitPromptPrice": {
					"description": "缓存命中提示每 1 token 价格 单位: 1/1000 usd",
					"type": "number"
				}
			},
			"required": [
				"completionPrice",
				"promptPrice"
			]
		},
		"APIPrice": {
			"$ref": "#/definitions/__type_7"
		},
		"ChatFormaterType": {
			"enum": [
				"deepseek_chat",
				"deepseek_chat_beta",
				"google_chat",
				"google_chat_gptge_compat",
				"openai_chat",
				"openai_text"
			],
			"type": "string"
		},
		"RequestFormaterType": {
			"enum": [
				"gemini",
				"openai"
			],
			"type": "string"
		},
		"TokensizerType": {
			"enum": [
				"cl100k_base",
				"deepseek",
				"p50k_base"
			],
			"type": "string"
		},
		"HttpApiModelCategory": {
			"$ref": "#/definitions/__type_6"
		},
		"Opt_1": {
			"$ref": "#/definitions/__type_3"
		},
		"P_2": {
			"type": "string",
			"const": "Test"
		},
		"__type_8": {
			"type": "object",
			"properties": {}
		},
		"Opt_2": {
			"$ref": "#/definitions/__type_8"
		}
	}
}